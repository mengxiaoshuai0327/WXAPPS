<!--pages/promotion/promotion.wxml-->
<view class="container">
  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="section">
    <view class="section-title">æ¨å¹¿ç»Ÿè®¡</view>
    <view class="stats">
      <view class="stat-card stat-card-blue" bindtap="viewAllInvitations">
        <view class="stat-icon">ğŸ‘¥</view>
        <text class="stat-value">{{stats.invited_count || 0}}</text>
        <text class="stat-label">æ€»é‚€è¯·äººæ•°</text>
      </view>
      <view class="stat-card stat-card-green" bindtap="viewRegistered">
        <view class="stat-icon">âœ“</view>
        <text class="stat-value">{{stats.registered_count || 0}}</text>
        <text class="stat-label">å·²æ³¨å†Œ</text>
      </view>
      <view class="stat-card stat-card-orange" bindtap="viewPurchased">
        <view class="stat-icon">ğŸ«</view>
        <text class="stat-value">{{stats.purchased_count || 0}}</text>
        <text class="stat-label">å·²è´­åˆ¸</text>
      </view>
    </view>
  </view>

  <!-- äºŒç»´ç å’Œæ“ä½œåŒºåŸŸ -->
  <view class="section">
    <!-- äºŒç»´ç æ˜¾ç¤º -->
    <view class="qr-code-section" wx:if="{{qrCodeUrl}}">
      <view class="qr-title">é‚€è¯·äºŒç»´ç </view>
      <view class="qr-container">
        <image class="qr-image" src="{{qrCodeUrl}}" mode="aspectFit"></image>
      </view>
      <text class="qr-tip">å¾®ä¿¡æ‰«ä¸€æ‰«ï¼Œç«‹å³æ³¨å†Œ</text>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-buttons">
      <button class="action-btn share-btn" open-type="share">
        <text class="btn-icon">ğŸ“¤</text>
        <text>åˆ†äº«é‚€è¯·</text>
      </button>
      <button class="action-btn save-btn" bindtap="saveQRCode" disabled="{{!qrCodeUrl}}">
        <text class="btn-icon">ğŸ’¾</text>
        <text>ä¿å­˜äºŒç»´ç </text>
      </button>
    </view>
  </view>

  <!-- æµ·æŠ¥Canvasï¼ˆéšè—ï¼‰ -->
  <canvas 
    canvas-id="posterCanvas" 
    id="posterCanvas"
    class="poster-canvas"
    style="width: 750px; height: 1334px;">
  </canvas>

  <!-- æµ·æŠ¥é¢„è§ˆå¼¹çª— -->
  <view class="poster-modal" wx:if="{{showPoster}}" bindtap="closePoster">
    <view class="poster-content" catchtap="stopPropagation">
      <view class="poster-header">
        <text class="poster-title">é‚€è¯·æµ·æŠ¥</text>
        <text class="poster-close" bindtap="closePoster">Ã—</text>
      </view>
      <image class="poster-preview" src="{{posterImage}}" mode="aspectFit"></image>
      <view class="poster-actions">
        <button class="poster-action-btn" bindtap="savePoster">ä¿å­˜åˆ°ç›¸å†Œ</button>
        <button class="poster-action-btn cancel-btn" bindtap="closePoster">å–æ¶ˆ</button>
      </view>
    </view>
  </view>
</view>


